# EvaTeam Workflow Enhancer

Этот пользовательский скрипт (UserScript) для Tampermonkey улучшает визуализацию диаграмм workflow в системе управления проектами EvaTeam. Заменяет стандартное отображение бизнес-процесса на более современное и интерактивное решение с использованием SvelteFlow.

## Особенности

- **Современный UI**: Преобразует статические диаграммы workflow в интерактивные
- **Улучшенный UX**: Добавляет функциональность перетаскивания элементов
- **Сохранение настроек**: Сохраняет пользовательские настройки в localStorage
- **Совместимость**: Поддерживает переключение между старой и новой версиями
- **Правильное отображение стилей**: Использует Shadow DOM для корректного отображения оригинального workflow со всеми стилями

## Технологии

- **JavaScript/ES6+**: Язык программирования
- **SvelteFlow**: Библиотека для интерактивных диаграмм
- **Svelte 5**: Фреймворк для построения пользовательских интерфейсов
- **Vite**: Инструмент сборки для разработки и продакшена
- **pnpm**: Менеджер пакетов для быстрой и эффективной установки зависимостей
- **DOM API**: Для взаимодействия с существующим DOM EvaTeam
- **localStorage**: Для сохранения пользовательских настроек
- **MutationObserver**: Для отслеживания изменений DOM

## Установка

1. Установите расширение Tampermonkey в вашем браузере
2. Скопируйте содержимое файла `dist/evateam-workflow-enhance.user.js` в новый скрипт Tampermonkey
3. Сохраните скрипт

## Разработка

### Режим разработки

Для целей разработки используйте Vite сервер:

1. Установите pnpm: `npm install -g pnpm` (если не установлен)
2. Установите зависимости: `pnpm install`
3. Запустите сервер разработки: `pnpm run dev`
4. Откройте http://localhost:3000 в браузере
5. Проверьте функциональность в режиме разработки
6. Откройте консоль разработчика (F12)
7. Проверьте логи: "HuEvaFlowEnhancer: ..."

### Сборка

Для окончательной сборки UserScript используйте команду:

```bash
pnpm run build-userscript
```

Результат: dist/evateam-workflow-enhance.user.js (готов к установке)

Для сборки веб-приложения используйте команду:

```bash
pnpm run build
```

Результат: файлы в директории dist/

## Архитектура

### src/HuEvaApi.js
Класс для взаимодействия с API EvaTeam, обеспечивает получение данных workflow, статусов и переходов.

### src/HuEvaFlowEnhancer.js
Основной класс для обработки данных workflow, парсинга HTML, извлечения узлов и ребер, управления состоянием приложения.

### src/main.js
Точка входа для приложения, объединяет все компоненты.

### dev/index.html
Файл для разработки и тестирования функциональности без установки Tampermonkey.

### dev/main.js
Точка входа для разработки, загружает mock-данные и инициализирует enhancer.

### dev/api/
Директория с mock-файлами API для разработки.

### dist/evateam-workflow-enhance.user.js
Финальный Tampermonkey-скрипт, результат сборки, готов к установке.


### vite.config.js
Конфигурация Vite для режима разработки, использует директорию 'dev' как корневую для разработки, что позволяет изолировать разработку от остальной части проекта. Запускает сервер на порту 3003 и компилирует файлы в директорию ../dist.

### vite.test.config.mjs
Конфигурация Vite для тестирования, используется для проверки работоспособности собранного проекта перед его использованием в реальных условиях. Запускает сервер на порту 3004 и использует ту же директорию вывода (./dist), что и основная сборка.

### vite.build.config.mjs
Конфигурация Vite для сборки Tampermonkey-скрипта, создает единый бандл в dist/ с Tampermonkey заголовками и динамической загрузкой SvelteFlow.


## Требования к коду

- Все комментарии в коде и документации должны быть на английском языке
- Русский язык допускается только в интерфейсе
- Подробные логи с префиксом "HuEvaFlowEnhancer:"
- Использование camelCase для переменных и функций
- Объектно-ориентированный подход с модульной организацией
- Проверка исключений и подробные сообщения об ошибках